From e1180af655719d73fac940343be13a6b38dce3e6 Mon Sep 17 00:00:00 2001
From: KobeNorris <kobenorriswu@gmail.com>
Date: Thu, 1 Dec 2022 17:56:08 -0600
Subject: [PATCH 1/2] feat: Update yarn config to support injection

---
 .../org/apache/hadoop/yarn/conf/YarnConfiguration.java | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java
index c1bb6aa68d2..db0bc731fd6 100644
--- a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java
+++ b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java
@@ -41,6 +41,8 @@
 import org.apache.hadoop.util.BasicDiskValidator;
 import org.apache.hadoop.util.StringUtils;
 import org.apache.hadoop.yarn.api.ApplicationConstants;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 @Public
 @Evolving
@@ -99,11 +101,19 @@
   @Deprecated
   public static final int APPLICATION_MAX_TAG_LENGTH = 100;
 
+  private static final Logger LOG =
+      LoggerFactory.getLogger(YarnConfiguration.class);
+
   static {
+    LOG.warn("2nd addDefaultResource start Loading");
     addDeprecatedKeys();
     Configuration.addDefaultResource(YARN_DEFAULT_CONFIGURATION_FILE);
     Configuration.addDefaultResource(YARN_SITE_CONFIGURATION_FILE);
     Configuration.addDefaultResource(RESOURCE_TYPES_CONFIGURATION_FILE);
+    Configuration.addDefaultResource("core-ctest.xml");
+    LOG.warn("2nd addDefaultResource complete Loading");
+    Configuration conf = new Configuration();
+    LOG.warn("hadoop.security.groups.negative-cache.secs = " + conf.get("hadoop.security.groups.negative-cache.secs"));
   }
 
   private static void addDeprecatedKeys() {
-- 
2.25.1


From fc79b3dfd23f2789de8dc5a179acac3d1acabe07 Mon Sep 17 00:00:00 2001
From: KobeNorris <kobenorriswu@gmail.com>
Date: Sat, 3 Dec 2022 00:54:02 -0600
Subject: [PATCH 2/2] feat: Remove logger

---
 .../org/apache/hadoop/yarn/conf/YarnConfiguration.java    | 8 --------
 1 file changed, 8 deletions(-)

diff --git a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java
index db0bc731fd6..f46c44827f4 100644
--- a/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java
+++ b/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-api/src/main/java/org/apache/hadoop/yarn/conf/YarnConfiguration.java
@@ -41,8 +41,6 @@
 import org.apache.hadoop.util.BasicDiskValidator;
 import org.apache.hadoop.util.StringUtils;
 import org.apache.hadoop.yarn.api.ApplicationConstants;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
 
 @Public
 @Evolving
@@ -101,19 +99,13 @@
   @Deprecated
   public static final int APPLICATION_MAX_TAG_LENGTH = 100;
 
-  private static final Logger LOG =
-      LoggerFactory.getLogger(YarnConfiguration.class);
-
   static {
-    LOG.warn("2nd addDefaultResource start Loading");
     addDeprecatedKeys();
     Configuration.addDefaultResource(YARN_DEFAULT_CONFIGURATION_FILE);
     Configuration.addDefaultResource(YARN_SITE_CONFIGURATION_FILE);
     Configuration.addDefaultResource(RESOURCE_TYPES_CONFIGURATION_FILE);
     Configuration.addDefaultResource("core-ctest.xml");
-    LOG.warn("2nd addDefaultResource complete Loading");
     Configuration conf = new Configuration();
-    LOG.warn("hadoop.security.groups.negative-cache.secs = " + conf.get("hadoop.security.groups.negative-cache.secs"));
   }
 
   private static void addDeprecatedKeys() {
-- 
2.25.1

